var _debug_=false;function _alert_(b,a){if(_debug_==true){if(a==undefined){alert(b)}else{alert(b+" "+a.message)}}}_console_={log:function(a){if((_debug_==true)&&(typeof console!="undefined")){console.log(a)}}};function select_menu_group(a){$(".menu_primary .navigation li").removeClass("group");if(a!=undefined){$(".menu_primary .navigation li#"+a).addClass("group")}}String.prototype.format_decimal=function(d,c){var e=this.split(".");if(!e[0]){e[0]=""}if(!e[1]){e[1]=""}e[1]=e[1].substr(0,c);while(String(e[0]).length<d){e[0]="0"+e[0]}while(String(e[1]).length<c){e[1]=e[1]+"0"}return e[0]+locale.number.separator.decimal+e[1]};var ccpopupObj=function(parent){this.html='<div class="ccbox"><div class="vcenter"><div class="content"><span class="b_close_box link" style="float:right;margin-right:10px">'+locale.popup.button.close+'</span><div><div class="head"></div><div class="body"></div><div class="commands"></div></div></div></div></div>';if(typeof parent!="string"){parent="BODY"}this.box=$(this.html).appendTo(parent);var self=this;$(this.box).find(".b_close_box").click(function(){self.hide()});this.custom=function(msg,title,buttons,fun,class_name){this.cleanup();$(this.box).addClass(class_name);var htmlbuttons="";var focus_ctrl_id=null;for(var button in buttons){var button_id="b_"+button.toLowerCase();if(typeof buttons[button]=="object"){var b=buttons[button]}else{var b={value:buttons[button],"class":""}}var h="";for(var n in b){if(n.toLowerCase()=="class"){h+=n+'="button '+button_id+" "+b[n]+'" '}else{if(n.toLowerCase()=="focus"){if(b[n]==1){focus_ctrl_id=button_id}}else{h+=n+'="'+b[n]+'" '}}}$(this.box).find(".commands").append('<input type="button" '+h+" />&nbsp;");if(typeof fun=="object"){$(this.box).find("."+button_id).click(eval("fun.on"+button))}}if(focus_ctrl_id!=null){$(this.box).find("."+focus_ctrl_id).focus()}return this.common(msg,title)},this.confirm=function(msg,title,fun){var self=this;return this.custom(msg,title,{Yes:{value:locale.popup.button.yes,"class":"main",focus:1},No:locale.popup.button.no},{onYes:function(){try{fun.onYes()}catch(e){}self.hide()},onNo:function(){try{fun.onNo()}catch(e){}self.hide()}},"ccbox_confirm")},this.error=function(msg,title){var self=this;return this.custom(msg,title,{Ok:""},{onOk:function(){self.hide()}},"ccbox_message ccbox_error")};this.warning=function(msg,title,fun){var self=this;return this.custom(msg,title,{Ok:""},{onOk:function(){try{fun.onOk()}catch(e){}self.hide()}},"ccbox_message ccbox_warning")};this.info=function(msg,title,fun){var self=this;return this.custom(msg,title,{Ok:{value:locale.popup.button.ok,"class":"main",focus:1}},{onOk:function(){try{fun.onOk()}catch(e){}self.hide()}},"ccbox_info")};this.dialog=function(msg,title){this.cleanup();$(this.box).addClass("ccbox_dialog");return this.common(msg,title)};this.common=function(msg,title){if(typeof title=="string"){$(this.box).find(".head").html(title)}if(typeof msg=="string"){$(this.box).find(".body").html(msg)}return this.show()};this.cleanup=function(){$(this.box).attr("class","ccbox");return this};this.show=function(){try{$(this.box).show()}catch(e){}return this};this.hide=function(){try{$(this.box).remove();delete this}catch(e){}};this.f_yes=function(){};this.f_no=function(){}};function getForm(s){var data=$(s).serializeArray();var res="";for(var i in data){res+=",'"+data[i].name.replace("'","\\'")+"':'"+data[i].value.replace("'","\\'")+"'"}if(res!=""){res=res.substr(1)}eval("res = {"+res+"}");var post=$("[post]").each(function(){res[$(this).attr("name")]=$(this).attr("post")});return res}function send_request_new(url,postdata,content,fun){if((typeof fun!="object")||(!fun.noBusy)){busy_msg_show()}var method="GET";if(typeof postdata=="object"){method="POST"}try{$.ajax({url:url,type:method,timeout:60000,cache:false,global:false,data:postdata,error:function(data,status,e){busy_msg_hide();if((typeof fun=="object")&&(typeof fun.onError=="function")){fun.onError(data,status)}},success:function(data){try{eval("var datao = "+data);if((typeof fun=="object")&&(typeof fun.onCommand=="function")){try{var datao_new=fun.onCommand(datao);if(typeof datao_new=="object"){datao=datao_new}}catch(e){}}switch(datao.cmd){case"cancel":busy_msg_hide();return true;break;case"redirect":document.location.href=datao.url;return true;break;case"db-error":busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.error(locale.popup.error.internal.msg,locale.popup.error.internal.title);return true;break;case"popup":busy_msg_hide();var ccpopup=new ccpopupObj();switch(datao.type){case"info":ccpopup.info(datao.msg);break;default:ccpopup.error(datao.msg);break}return true;break;case"no-data":busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.warning(locale.popup.warning.not_found.msg,locale.popup.warning.not_found.title);return true;break;default:busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.error(locale.popup.error.internal.msg,locale.popup.error.internal.title);return true;break}}catch(e){}if((typeof fun=="object")&&(typeof fun.onContentBegin=="function")){try{data=fun.onContentBegin(data)}catch(e){}}busy_msg_hide();if(typeof content=="string"){$(content).html(data)}if((typeof fun=="object")&&(typeof fun.onContentEnd=="function")){try{fun.onContentEnd(data)}catch(e){}}}})}catch(e){busy_msg_hide()}}function val_date(c,a,g,f){if(a==true){c=str_trim(c)}if(g==true){if(c.length==0){return false}}else{if(c.length==0){return true}}try{if(/^([0-9][0-9][0-9][0-9])-(0?[1-9]|1[0-2])-([0-2]?[0-9]|3[0-1])$/.test(c)==false){return false}var d=c.substr(0,4);var j=c.substr(5,2);var b;if((j[1]<"0")||(j[1]>"9")){j=c.substr(5,1);b=c.substr(7,2);if((b[1]<"0")||(b[1]>"9")){b=c.substr(7,1)}}else{b=c.substr(8,2);if((b[1]<"0")||(b[1]>"9")){b=c.substr(8,1)}}for(i=0;i<d.length;i++){if((d[i]<"0")||(d[i]>"9")){return false}}for(i=0;i<j.length;i++){if((j[i]<"0")||(j[i]>"9")){return false}}for(i=0;i<b.length;i++){if((b[i]<"0")||(b[i]>"9")){return false}}if(is_valid_date(d,j,b)==false){return false}if(typeof(f)!="undefined"){if(val_date(f,true,true)){if(f>c){return false}}}}catch(h){return false}return true}function is_valid_date(b,c,a){if(isNaN(b)){return false}if(isNaN(c)){return false}if(isNaN(a)){return false}if(c>12){return false}if((c==1)||(c==3)||(c==5)||(c==7)||(c==8)||(c==10)||(c==12)){if(a>31){return false}}else{if((c==4)||(c==6)||(c==9)||(c==11)){if(a>30){return false}}else{if((((b%4)==0)&&((b%100)!=0))||((b%400)==0)){if(a>29){return false}}else{if(a>28){return false}}}}return true}function is_numeric(a){return(a-0)==a&&a.length>0}String.prototype.ReplaceAll=function(c,d){var a=this;var b=a.indexOf(c);while(b!=-1){a=a.replace(c,d);b=a.indexOf(c)}return a};function val_email(c,a,b){if(a==true){c=str_trim(c)}if(b==true){if(c.length==0){return false}}else{if(c.length==0){return true}}if(/^([a-zA-Z0-9\+_\-]+)(\.[a-zA-Z0-9\+_\-]+)*@([a-zA-Z0-9\-]+\.)+[a-zA-Z]{2,6}$/.test(c)==false){return false}return true}function str_trim(b){try{b=b.toString();return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}catch(a){return b}}function set_datepicker(c,d){var b=false;var a="Y-m-d";if(d!=undefined){if(d.allowDelete==true){b=true}if(d.allowDelete==false){b=false}if(d.format!=undefined){a=d.format}}$(c).blur(function(){try{var f=locale.date.fromString($(c).val());$(this).attr("post",locale.date.toString(f,"y-MM-dd"))}catch(g){_alert_(g)}});$(c).keydown(function(){$(this).DatePickerHide()});return $(c).DatePicker({format:a,date:$(c).val(),current:$(c).val(),starts:1,allowDelete:b,position:"bottom",hideOnChange:true,locale:{days:[locale.date.dayname[0],locale.date.dayname[1],locale.date.dayname[2],locale.date.dayname[3],locale.date.dayname[4],locale.date.dayname[5],locale.date.dayname[6]],daysShort:[String(locale.date.dayname[0]).substr(0,3),String(locale.date.dayname[1]).substr(0,3),String(locale.date.dayname[2]).substr(0,3),String(locale.date.dayname[3]).substr(0,3),String(locale.date.dayname[4]).substr(0,3),String(locale.date.dayname[5]).substr(0,3),String(locale.date.dayname[6]).substr(0,3)],daysMin:[String(locale.date.dayname_short[0]),String(locale.date.dayname_short[1]),String(locale.date.dayname_short[2]),String(locale.date.dayname_short[3]),String(locale.date.dayname_short[4]),String(locale.date.dayname_short[5]),String(locale.date.dayname_short[6])],months:[locale.date.monthname[0],locale.date.monthname[1],locale.date.monthname[2],locale.date.monthname[3],locale.date.monthname[4],locale.date.monthname[5],locale.date.monthname[6],locale.date.monthname[7],locale.date.monthname[8],locale.date.monthname[9],locale.date.monthname[10],locale.date.monthname[11]],monthsShort:[String(locale.date.monthname[0]).substr(0,3),String(locale.date.monthname[1]).substr(0,3),String(locale.date.monthname[2]).substr(0,3),String(locale.date.monthname[3]).substr(0,3),String(locale.date.monthname[4]).substr(0,3),String(locale.date.monthname[5]).substr(0,3),String(locale.date.monthname[6]).substr(0,3),String(locale.date.monthname[7]).substr(0,3),String(locale.date.monthname[8]).substr(0,3),String(locale.date.monthname[9]).substr(0,3),String(locale.date.monthname[10]).substr(0,3),String(locale.date.monthname[11]).substr(0,3)],weekMin:locale.date.weekname},onBeforeShow:function(){try{var f=$(c).val();f=locale.date.fromString(f);if(isNaN(f.getTime())){f=new Date()}$(c).DatePickerSetDate(f,true)}catch(g){}},onChange:function(f,e){$(c).val(locale.date.toString(e));$(c).attr("POST",locale.date.toString(e,"y-MM-dd"));$(c).trigger("change");$(c).DatePickerHide()}})}$(function(){$(".content_error_con").ajaxError(function(c,b,a){});$(".content_error_con").ajaxSuccess(function(a,c,b){})});function busy_msg_show(){$(function(){$("#busy:hidden").show()})}function busy_msg_hide(){$(function(){$("#busy").hide()})}(function(a){a.fn.extend({webtoolkitMenu:function(b){return this.each(function(){var d=a(this);a("> li > ul",d).each(function(e){a(this).css("top",19);a("li > a",a(this)).each(function(f){a(this).click(function(){a("li",d).removeClass("over dropped")})});a("li",a(this)).each(function(f){var g=a(this);if(a("> ul",a(this)).size()>0){a("> a",a(this)).append('<span class="submenu">►</span>');a("> label",a(this)).append('<span class="submenu">►</span>')}})});var c=null;a("> li",d).hover(function(){var e=a(this);e.addClass("over");if(c!=null){c.clearQueue();c.removeClass("dropped")}c=a(this);a(this).clearQueue();a(this).addClass("dropped");a("> ul",e).css("top",e.outerHeight());if(e.hasClass("expand_to_left")){a("> ul",e).each(function(f){a(this).css("left",e.outerWidth()-a(this).outerWidth())})}},function(){a(this).removeClass("over");a(this).clearQueue();a(this).delay(600).queue(function(e){a(this).removeClass("dropped");e()})});a("> li ul > li",d).hover(function(){var e=a(this);a(this).addClass("over");a(this).clearQueue();a(this).delay(400).queue(function(f){a(this).addClass("dropped");a("> ul",e).css("top",e.position().top);if(e.hasClass("expand_to_left")){a("> ul",e).each(function(g){a(this).css("left",e.position().left-a(this).outerWidth())})}else{a("> ul",e).each(function(g){a(this).css("left",e.position().left+e.outerWidth())})}f()})},function(){a(this).removeClass("over");a(this).clearQueue();a(this).delay(400).queue(function(e){a(this).removeClass("dropped");e()})})})}})})(jQuery);function menu_click(a,b){if(b==true){busy_msg_show();document.location.href=a}else{var c={};send_request_new(a,c,"#content")}}(function($){$.addFlex=function(t,p){if(t.grid){return false}p=$.extend({id:"flexi",prefix:"",mode:0,height:200,width:"auto",striped:true,novstripe:false,buttons:false,minwidth:30,minheight:80,resizable:true,url:false,method:"POST",dataType:"json",errormsg:"Connection Error",nowrap:true,title:false,pagermode:0,page:1,total:1,usepager:true,nrofpagerboxes:10,pagestat:"Displaying {from} to {to} of {total} items",bottom_line:"",useRp:true,rp:15,rpOptions:[10,15,20,25,40],procmsg:"Processing, please wait ...",pageNrMsg:"Page",pageNrOfMsg:"of",query:"",qtype:"",nomsg:"No items",minColToggle:1,showToggleBtn:true,hideOnSubmit:true,autoload:true,blockOpacity:0.5,onError:function(){var ccpopup=new ccpopupObj();ccpopup.error("Internal Error.","Error")},onToggleCol:false,onChangeSort:false,onSuccess:false,selectRows:false,singleSelect:true,showTableToggleBtn:true,onSubmit:false,onStartLoading:function(){busy_msg_show()},onEndLoading:function(){busy_msg_hide()},onDataDisplayed:function(total_nr){},contextMenu:false,contextMenuIconPath:"",contextMenuTempContent:"#content",onContextMenuClick:function(row_id,action,row_data,menuItem,menu){},onSingleItemSelected:function(id,row_data){},onSingleItemUnSelected:function(id,row_data){},onItemSelected:function(id,row_data){},onItemClicked:function(id,row_data){},onItemUnSelected:function(id,row_data){},preProcess:function(data){return data},templRow:{row:["<td>",'<table class="client_grid" cellspacing="0" cellpadding="0"><tbody>',"<tr>",'<td class="pic" rowspan="3"><span><%=cell.pic%></span></td>','<td class="y_name"><span><%=cell.yacht_name%></span></td>','<td class="det">','<span class="type"><%=cell.yacht_type%></span>','<span class="people"><%=cell.bunk%></span>','<span class="port"><%=cell.port%></span>',"</td>","</tr>","<tr>",'<td class="y_desc" rowspan="2"><span><%=cell.yacht_desc%></span></td>','<td class="reserv">','<span class="period"><%=cell.period%></span>','<span class="days">(<%=cell.day_count%>)</span>','<span class="price"><%=cell.total_price%></span>',"</td>","</tr>","<tr>",'<td class="button" >','<img src="images/client/ui_grid_button_view.png" id="button_view" oid="<%=cell.id%>" sdate="<%=cell.start_date%>" edate="<%=cell.end_date%>">','<img src="images/client/ui_grid_button_order.png" id="button_order" oid="<%=cell.id%>" sdate="<%=cell.start_date%>" edate="<%=cell.end_date%>">',"</td>","</tr>","</tbody></table>","</td>",]},templStatusline:{0:{pager:['<div class="pGroup"> ','<div class="pFirst pButton"><span></span></div>','<div class="pPrev pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup">','<span class="pcontrol">-=1=- <input type="text" size="4" value="1" /> -=2=- <span> 1 </span></span>',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup pBoxes">',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pNext pButton"><span></span></div>','<div class="pLast pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pReload pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"><span class="pPageStat"></span></div>'],pageBox:['<div class="pBox pButton pButtonW"><span><span>-=1=-</span></span></div>'],pageBoxActive:['<div class="pBox pButton pButtonW active"><span><span>-=1=-</span></span></div>']},1:{pager:['<div class="pGroup"> ','<div class="pFirst pButton"><span></span></div>','<div class="pPrev pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup pBoxes">',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pNext pButton"><span></span></div>','<div class="pLast pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pReload pButton"><span></span></div> ',"</div>"],pageBox:['<div class="pBox pButton pButtonW"><span><span>-=1=-</span></span></div>'],pageBoxActive:['<div class="pBox pButton pButtonW active"><span><span>-=1=-</span></span></div>']},2:{pager:['<div class="pGroup"> ','<div class="pFirst pButton"><span></span></div>','<div class="pPrev pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup">','<span class="pcontrol">-=1=- <input type="text" size="4" value="1" /> -=2=- <span> 1 </span></span>',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pNext pButton"><span></span></div>','<div class="pLast pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"> ','<div class="pReload pButton"><span></span></div> ',"</div> ",'<div class="btnseparator"></div> ','<div class="pGroup"><span class="pPageStat"></span></div>'],pageBox:['<div class="pBox pButton pButtonW"><span><span>-=1=-</span></span></div>'],pageBoxActive:['<div class="pBox pButton pButtonW active"><span><span>-=1=-</span></span></div>']}}},p);$(t).show().attr({cellPadding:0,cellSpacing:0,border:0}).removeAttr("width");var g={hset:{},rePosDrag:function(){if(p.mode!=0){return}var cdleft=0-this.hDiv.scrollLeft;if(this.hDiv.scrollLeft>0){cdleft-=Math.floor(p.cgwidth/2)}$(g.cDrag).css({top:g.hDiv.offsetTop+1});var cdpad=this.cdpad;$("div",g.cDrag).hide();$("thead tr:first th:visible",this.hDiv).each(function(){var n=$("thead tr:first th:visible",g.hDiv).index(this);var cdpos=parseInt($("div",this).width());var ppos=cdpos;if(cdleft==0){cdleft-=Math.floor(p.cgwidth/2)}cdpos=cdpos+cdleft+cdpad;$("div:eq("+n+")",g.cDrag).css({left:cdpos+"px"}).show();cdleft=cdpos})},fixHeight:function(newH){if(p.mode!=0){return false}newH=false;if(!newH){newH=$(g.bDiv).height()}var hdHeight=$(this.hDiv).height();$("div",this.cDrag).each(function(){$(this).height(newH+hdHeight)});if(p.mode==0){var nd=parseInt($(g.nDiv).height());if(nd>newH){$(g.nDiv).height(newH).width(200)}else{$(g.nDiv).height("auto").width("auto")}}$(g.block).css({height:newH,marginBottom:(newH*-1)});var hrH=g.bDiv.offsetTop+newH;if(p.height!="auto"&&p.resizable){hrH=g.vDiv.offsetTop}$(g.rDiv).css({height:hrH})},dragStart:function(dragtype,e,obj){if(p.mode!=0){return}if(dragtype=="colresize"){$(g.nDiv).hide();$(g.nBtn).hide();var n=$("div",this.cDrag).index(obj);var ow=$("th:visible div:eq("+n+")",this.hDiv).width();$(obj).addClass("dragging").siblings().hide();$(obj).prev().addClass("dragging").show();this.colresize={startX:e.pageX,ol:parseInt(obj.style.left),ow:ow,n:n};$("body").css("cursor","col-resize")}else{if(dragtype=="vresize"){var hgo=false;$("body").css("cursor","row-resize");if(obj){hgo=true;$("body").css("cursor","col-resize")}this.vresize={h:p.height,sy:e.pageY,w:p.width,sx:e.pageX,hgo:hgo}}else{if(dragtype=="colMove"){$(g.nDiv).hide();$(g.nBtn).hide();this.hset=$(this.hDiv).offset();this.hset.right=this.hset.left+$("table",this.hDiv).width();this.hset.bottom=this.hset.top+$("table",this.hDiv).height();this.dcol=obj;this.dcoln=$("th",this.hDiv).index(obj);this.colCopy=document.createElement("div");this.colCopy.className="colCopy";this.colCopy.innerHTML=obj.innerHTML;if($.browser.msie){this.colCopy.className="colCopy ie"}$(this.colCopy).css({position:"absolute","float":"left",display:"none",textAlign:obj.align});$("body").append(this.colCopy);$(this.cDrag).hide()}}}$("body").noSelect()},dragMove:function(e){if(p.mode!=0){return}if(this.colresize){var n=this.colresize.n;var diff=e.pageX-this.colresize.startX;var nleft=this.colresize.ol+diff;var nw=this.colresize.ow+diff;if(nw>p.minwidth){$("div:eq("+n+")",this.cDrag).css("left",nleft);this.colresize.nw=nw}}else{if(this.vresize){var v=this.vresize;var y=e.pageY;var diff=y-v.sy;if(!p.defwidth){p.defwidth=p.width}if(p.width!="auto"&&!p.nohresize&&v.hgo){var x=e.pageX;var xdiff=x-v.sx;var newW=v.w+xdiff;if(newW>p.defwidth){this.gDiv.style.width=newW+"px";p.width=newW}}var newH=v.h+diff;if((newH>p.minheight||p.height<p.minheight)&&!v.hgo){this.bDiv.style.height=newH+"px";p.height=newH;this.fixHeight(newH)}v=null}else{if(this.colCopy){$(this.dcol).addClass("thMove").removeClass("thOver");if(e.pageX>this.hset.right||e.pageX<this.hset.left||e.pageY>this.hset.bottom||e.pageY<this.hset.top){$("body").css("cursor","move")}else{$("body").css("cursor","pointer")}$(this.colCopy).css({top:e.pageY+10,left:e.pageX+20,display:"block"})}}}},dragEnd:function(){if(p.mode!=0){return}if(this.colresize){var n=this.colresize.n;var nw=this.colresize.nw;$("th:visible div:eq("+n+")",this.hDiv).css("width",nw);$("tr",this.bDiv).each(function(){$("td:visible div:eq("+n+")",this).css("width",nw)});this.hDiv.scrollLeft=this.bDiv.scrollLeft;$("div:eq("+n+")",this.cDrag).siblings().show();$(".dragging",this.cDrag).removeClass("dragging");this.rePosDrag();this.fixHeight();this.colresize=false}else{if(this.vresize){this.vresize=false}else{if(this.colCopy){$(this.colCopy).remove();if(this.dcolt!=null){if(this.dcoln>this.dcolt){$("th:eq("+this.dcolt+")",this.hDiv).before(this.dcol)}else{$("th:eq("+this.dcolt+")",this.hDiv).after(this.dcol)}this.switchCol(this.dcoln,this.dcolt);$(this.cdropleft).remove();$(this.cdropright).remove();this.rePosDrag()}this.dcol=null;this.hset=null;this.dcoln=null;this.dcolt=null;this.colCopy=null;$(".thMove",this.hDiv).removeClass("thMove");$(this.cDrag).show()}}}$("body").css("cursor","default");$("body").noSelect(false)},toggleCol:function(cid,visible){if(p.mode!=0){return null}var ncol=$("th[axis='col"+cid+"']",this.hDiv)[0];var n=$("thead th",g.hDiv).index(ncol);var cb=$("input[value="+cid+"]",g.nDiv)[0];if(visible==null){visible=ncol.hide}if($("input:checked",g.nDiv).length<p.minColToggle&&!visible){return false}if(visible){ncol.hide=false;$(ncol).show();cb.checked=true}else{ncol.hide=true;$(ncol).hide();cb.checked=false}$("tbody tr",t).each(function(){if(visible){$("td:eq("+n+")",this).show()}else{$("td:eq("+n+")",this).hide()}});this.rePosDrag();if(p.onToggleCol){p.onToggleCol(cid,visible)}return visible},switchCol:function(cdrag,cdrop){if(p.mode!=0){return}$("tbody tr",t).each(function(){if(cdrag>cdrop){$("td:eq("+cdrop+")",this).before($("td:eq("+cdrag+")",this))}else{$("td:eq("+cdrop+")",this).after($("td:eq("+cdrag+")",this))}});if(cdrag>cdrop){$("tr:eq("+cdrop+")",this.nDiv).before($("tr:eq("+cdrag+")",this.nDiv))}else{$("tr:eq("+cdrop+")",this.nDiv).after($("tr:eq("+cdrag+")",this.nDiv))}if($.browser.msie&&$.browser.version<7){$("tr:eq("+cdrop+") input",this.nDiv)[0].checked=true}this.hDiv.scrollLeft=this.bDiv.scrollLeft},scroll:function(){this.hDiv.scrollLeft=this.bDiv.scrollLeft;this.rePosDrag()},addData:function(data){try{p.onEndLoading.call(self)}catch(e){}try{var datao;if(p.dataType=="json"){datao=data}else{eval("var datao = "+data)}switch(datao.cmd){case"cancel":busy_msg_hide();return false;break;case"redirect":document.location.href=datao.url;return false;break;case"db-error":busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.error("Internal Error.","Error");return false;break;case"no-data":busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.warning("Requested object doesn't exist.","NO DATA");return false;break;case undefined:break;default:busy_msg_hide();var ccpopup=new ccpopupObj();ccpopup.error("Internal Error.","Error");return false;break}}catch(e){}var bind_temp_elem=p.contextMenuTempContent+" ."+p.id+"_temp";if($(bind_temp_elem).size()>0){$(bind_temp_elem).html("")}if(p.preProcess){data=p.preProcess(data)}$(".pReload",this.pDiv).removeClass("loading");this.loading=false;if(!data){$(".pPageStat",this.pDiv).html(p.errormsg);return false}if(p.dataType=="xml"){p.total=+$("rows total",data).text()}else{p.total=data.total}if(p.total==0){$("tr, a, td, div",t).unbind();$(t).empty();p.pages=1;p.page=1;this.buildpager();$(".pPageStat",this.pDiv).html(p.nomsg);try{p.onDataDisplayed.call(self,p.total)}catch(e){}return false}p.pages=Math.ceil(p.total/p.rp);if(p.dataType=="xml"){p.page=+$("rows page",data).text()}else{p.page=data.page}this.buildpager();var tbody=document.createElement("tbody");if(p.dataType=="json"){$("tr",t).unbind();$(t).empty();var globThis=this;$.each(data.rows,function(i,row){var tr=document.createElement("tr");if(i%2&&p.striped){tr.className="erow"}if(row.id){tr.id="row"+row.id}if(row.style){$(tr).addClass(row.style)}if(p.mode==0){$("thead tr:first th",g.hDiv).each(function(){var td=document.createElement("td");var idx=$(this).attr("axis").substr(3);td.align=this.align;row_cell_val_i=0;for(row_cell_val in row.cell){if(row_cell_val_i==idx){break}row_cell_val_i++}td.innerHTML=row.cell[row_cell_val];$(tr).append(td);td=null});if($("thead",this.gDiv).length<1){for(idx in row.cell){var td=document.createElement("td");td.innerHTML=row.cell[idx];$(tr).append(td);td=null}}}else{td=g.buildTmpl(p.templRow.row.join(""),row);$(tr).append(td)}$(tbody).append(tr);var bind_temp_elem=p.contextMenuTempContent+" ."+p.id+"_temp";if($(bind_temp_elem).size()==0){$(p.contextMenuTempContent).append('<div class="'+p.id+'_temp"></div>')}if(p.contextMenu==true){var menu1=[];$.each(row.menu,function(menu_i,menu_row){if(menu_row.name=="---"){menu1[menu_i]=$.contextMenu.separator}else{menu1[menu_i]=new Array();menu1[menu_i][menu_row.name]=new Array();menu1[menu_i][menu_row.name]["onclick"]=function(menuItem,menu){try{p.onContextMenuClick.call(self,row.id,menu_row.action,row.cell,menuItem,menu)}catch(e){}};if(!(menu_row.icon===undefined)){if(menu_row.disabled==true){menu1[menu_i][menu_row.name]["icon"]=p.contextMenuIconPath+menu_row.icon.replace(".","_.");menu1[menu_i][menu_row.name]["disabled"]=true}else{menu1[menu_i][menu_row.name]["icon"]=p.contextMenuIconPath+menu_row.icon}}if(!(menu_row.className===undefined)){menu1[menu_i][menu_row.name]["className"]=menu_row.className}if(!(menu_row.hoverClassName===undefined)){menu1[menu_i][menu_row.name]["hoverClassName"]=menu_row.hoverClassName}}});$(function(){$(tr).contextMenu(menu1,{appendTo:bind_temp_elem})})}else{var menu1=[];$(function(){$(tr).contextMenu(menu1,{appendTo:bind_temp_elem})})}globThis.addRowProp($(tr),row.cell);tr=null});$(t).append(tbody);if(p.mode==0){this.addCellProp()}else{this.addRowProp()}}else{$("tr",t).unbind();$(t).empty();$(t).append(tbody);this.addCellProp();this.addRowProp()}this.rePosDrag();tbody=null;data=null;i=null;if(p.onSuccess){p.onSuccess()}if(p.hideOnSubmit){$(g.block).remove()}this.hDiv.scrollLeft=this.bDiv.scrollLeft;if($.browser.opera){$(t).css("visibility","visible")}try{p.onDataDisplayed.call(self,p.total)}catch(e){}},changeSort:function(th){if(this.loading){return true}if(p.mode==0){$(g.nDiv).hide();$(g.nBtn).hide()}if(p.sortname==$(th).attr("abbr")){if(p.sortorder=="asc"){p.sortorder="desc"}else{p.sortorder="asc"}}$(th).addClass("sorted").siblings().removeClass("sorted");$(".sdesc",this.hDiv).removeClass("sdesc");$(".sasc",this.hDiv).removeClass("sasc");$("div",th).addClass("s"+p.sortorder);p.sortname=$(th).attr("abbr");if(p.onChangeSort){p.onChangeSort(p.sortname,p.sortorder)}else{this.populate()}},buildpager:function(){$(".pcontrol input",this.pDiv).val(p.page);$(".pcontrol span",this.pDiv).html(p.pages);var r1=(p.page-1)*p.rp+1;var r2=r1+p.rp-1;if(p.total<r2){r2=p.total}var stat=p.pagestat;stat=stat.replace(/{from}/,r1);stat=stat.replace(/{to}/,r2);stat=stat.replace(/{total}/,p.total);$(".pPageStat",this.pDiv).html(stat);var boxnr=p.nrofpagerboxes;if(p.pages==0){$("div.pBoxes",g.pDiv).html("")}else{if(boxnr>0){$("div.pBoxes",g.pDiv).html("");if(boxnr>p.pages){boxnr=p.pages}var boxhtml=p.templStatusline[p.pagermode].pageBox.join("");var boxhtmla=p.templStatusline[p.pagermode].pageBoxActive.join("");if(p.pages==1){var boxhtmla_=boxhtmla.replace("-=1=-","1");$("div.pBoxes",g.pDiv).append(boxhtmla_)}else{var startPage=p.page-Math.floor(boxnr/2);if(startPage<1){startPage=1}var endPage=startPage+boxnr-1;if(endPage>p.pages){startPage=startPage+(p.pages-endPage)}if(startPage<1){startPage=1}if(endPage>p.pages){endPage=p.pages}var bhtml="";for(i=startPage;i<=endPage;i++){if(i==p.page){bhtml=boxhtmla.replace("-=1=-",i);$("div.pBoxes",g.pDiv).append(bhtml)}else{bhtml=boxhtml.replace("-=1=-",i);$("div.pBoxes",g.pDiv).append(bhtml)}}}$("div.pBoxes .pBox span span",g.pDiv).click(function(){g.changePage($(this).html())})}}},populate:function(){if(this.loading){return true}if(p.onSubmit){var gh=p.onSubmit();if(!gh){return false}}this.loading=true;if(!p.url){return false}try{p.onStartLoading.call(self)}catch(e){}$(".pPageStat",this.pDiv).html(p.procmsg);$(".pReload",this.pDiv).addClass("loading");$(g.block).css({top:g.bDiv.offsetTop});if(p.hideOnSubmit){$(this.gDiv).prepend(g.block)}if($.browser.opera){$(t).css("visibility","hidden")}if(!p.newp){p.newp=1}if(p.page>p.pages){p.page=p.pages}var param=[{name:"page",value:p.newp},{name:"rp",value:p.rp},{name:"sortname",value:p.sortname},{name:"sortorder",value:p.sortorder},{name:"query",value:p.query},{name:"qtype",value:p.qtype},{name:"office",value:$("input#office").val()},{name:"mode",value:$(p.prefix+" input#mode").val()},{name:"perm",value:$(p.prefix+" input#perm").val()},{name:"ajax",value:"1"},{name:"flex_id",value:p.id}];if(p.params){for(var pi=0;pi<p.params.length;pi++){param[param.length]=p.params[pi]}}$.ajax({type:p.method,url:p.url,data:param,dataType:p.dataType,success:function(data){g.addData(data)},error:function(XMLHttpRequest,textStatus){try{try{p.onError.call(self)}catch(e){}p.onEndLoading.call(self)}catch(e){}}})},doSearch:function(){p.query=$("input[name=q]",g.sDiv).val();p.qtype=$("select[name=qtype]",g.sDiv).val();p.newp=1;this.populate()},changePage:function(ctype){if(this.loading){return true}switch(ctype){case"first":p.newp=1;break;case"prev":if(p.page>1){p.newp=parseInt(p.page)-1}break;case"next":if(p.page<p.pages){p.newp=parseInt(p.page)+1}break;case"last":p.newp=p.pages;break;case"input":var nv=parseInt($(".pcontrol input",this.pDiv).val());if(isNaN(nv)){nv=1}if(nv<1){nv=1}else{if(nv>p.pages){nv=p.pages}}$(".pcontrol input",this.pDiv).val(nv);p.newp=nv;break;default:if(is_numeric(ctype)==true){p.newp=ctype}break}if(p.newp==p.page){return false}if(p.onChangePage){p.onChangePage(p.newp)}else{this.populate()}},addCellProp:function(){$("tbody tr td",g.bDiv).each(function(){var tdDiv=document.createElement("div");var n=$("td",$(this).parent()).index(this);var pth=$("th:eq("+n+")",g.hDiv).get(0);if(pth!=null){if(p.sortname==$(pth).attr("abbr")&&p.sortname){this.className="sorted"}$(tdDiv).css({textAlign:pth.align,width:$("div:first",pth)[0].style.width});if(pth.hide){$(this).css("display","none")}}if(p.nowrap==false){$(tdDiv).css("white-space","normal")}if(this.innerHTML==""){this.innerHTML="&nbsp;"}tdDiv.innerHTML=this.innerHTML;var prnt=$(this).parent()[0];var pid=false;if(prnt.id){pid=prnt.id.substr(3)}if(pth!=null){if(pth.process){pth.process(tdDiv,pid)}}$(this).empty().append(tdDiv).removeAttr("width")})},getCellDim:function(obj){var ht=parseInt($(obj).height());var pht=parseInt($(obj).parent().height());var wt=parseInt(obj.style.width);var pwt=parseInt($(obj).parent().width());var top=obj.offsetParent.offsetTop;var left=obj.offsetParent.offsetLeft;var pdl=parseInt($(obj).css("paddingLeft"));var pdt=parseInt($(obj).css("paddingTop"));return{ht:ht,wt:wt,top:top,left:left,pdl:pdl,pdt:pdt,pht:pht,pwt:pwt}},addRowProp:function(rows,row_data){if(rows==null){rows=$("tbody tr",g.bDiv)}rows.each(function(){$(this).click(function(e){var obj=(e.target||e.srcElement);if(obj.href||obj.type){return true}try{p.onItemClicked.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}if($(this).hasClass("trSelected")==false){try{p.onItemSelected.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}if(p.singleSelect){try{p.onSingleItemSelected.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}}}else{try{p.onItemUnSelected.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}if(p.singleSelect){try{p.onSingleItemUnSelected.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}}}if(p.selectRows==true){$(this).toggleClass("trSelected")}else{$(this).siblings().removeClass("trSelected");$(this).removeClass("trSelected")}if(p.singleSelect){$(this).siblings().each(function(){if($(this).hasClass("trSelected")==true){try{p.onItemUnSelected.call(self,$(this).attr("id").substr(3),row_data)}catch(e){}}});$(this).siblings().removeClass("trSelected")}}).mousedown(function(e){if(e.shiftKey){if(p.selectRows==true){$(this).toggleClass("trSelected");g.multisel=true}this.focus();$(g.gDiv).noSelect()}}).mouseup(function(){if(g.multisel){g.multisel=false;$(g.gDiv).noSelect(false)}}).hover(function(e){if(g.multisel){if(p.selectRows==true){$(this).toggleClass("trSelected")}}},function(){});if($.browser.msie&&$.browser.version<7){$(this).hover(function(){$(this).addClass("trOver")},function(){$(this).removeClass("trOver")})}})},buildTmpl:function(str,data){var fn=!/\W/.test(str)?cache[str]=cache[str]||tmpl(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn},pager:0};if(p.colModel){thead=document.createElement("thead");tr=document.createElement("tr");for(i=0;i<p.colModel.length;i++){var cm=p.colModel[i];var th=document.createElement("th");th.innerHTML=cm.display;if(cm.name&&cm.sortable){$(th).attr("abbr",cm.name)}$(th).attr("axis","col"+i);if(cm.align){th.align=cm.align}if(cm.width){$(th).attr("width",cm.width)}if(cm.hide){th.hide=true}if(cm.process){th.process=cm.process}$(tr).append(th)}$(thead).append(tr);$(t).prepend(thead)}g.gDiv=document.createElement("div");g.mDiv=document.createElement("div");g.hDiv=document.createElement("div");g.bDiv=document.createElement("div");g.vDiv=document.createElement("div");g.rDiv=document.createElement("div");if(p.mode==0){g.cDrag=document.createElement("div")}g.block=document.createElement("div");if(p.mode==0){g.nDiv=document.createElement("div");g.nBtn=document.createElement("div")}g.iDiv=document.createElement("div");g.tDiv=document.createElement("div");g.sDiv=document.createElement("div");if(p.usepager){g.pDiv=document.createElement("div")}g.hTable=document.createElement("table");g.gDiv.className="flexigrid "+p.id;if(p.width!="auto"){g.gDiv.style.width=p.width+"px"}if($.browser.msie){$(g.gDiv).addClass("ie")}if(p.novstripe){$(g.gDiv).addClass("novstripe")}$(t).before(g.gDiv);$(g.gDiv).append(t);if(p.buttons){g.tDiv.className="tDiv";var tDiv2=document.createElement("div");tDiv2.className="tDiv2";for(i=0;i<p.buttons.length;i++){var btn=p.buttons[i];if(!btn.separator){var btnDiv=document.createElement("div");btnDiv.className="fbutton";btnDiv.innerHTML="<div><span>"+btn.name+"</span></div>";if(btn.bclass){$("span",btnDiv).addClass(btn.bclass).css({paddingLeft:20})}btnDiv.onpress=btn.onpress;btnDiv.name=btn.name;if(btn.onpress){$(btnDiv).click(function(){this.onpress(this.name,g.gDiv)})}$(tDiv2).append(btnDiv);if($.browser.msie&&$.browser.version<7){$(btnDiv).hover(function(){$(this).addClass("fbOver")},function(){$(this).removeClass("fbOver")})}}else{$(tDiv2).append("<div class='btnseparator'></div>")}}$(g.tDiv).append(tDiv2);$(g.tDiv).append("<div style='clear:both'></div>");$(g.gDiv).prepend(g.tDiv)}g.hDiv.className="hDiv";$(t).before(g.hDiv);g.hTable.cellPadding=0;g.hTable.cellSpacing=0;$(g.hDiv).append('<div class="hDivBox"></div>');$("div",g.hDiv).append(g.hTable);var thead=$("thead:first",t).get(0);if(thead){$(g.hTable).append(thead)}thead=null;if(!p.colmodel){var ci=0}$("thead tr:first th",g.hDiv).each(function(){var thdiv=document.createElement("div");if($(this).attr("abbr")){$(this).click(function(e){if(!$(this).hasClass("thOver")){return false}var obj=(e.target||e.srcElement);if(obj.href||obj.type){return true}g.changeSort(this)});if($(this).attr("abbr")==p.sortname){this.className="sorted";thdiv.className="s"+p.sortorder}}if(this.hide){$(this).hide()}if(!p.colmodel){$(this).attr("axis","col"+ci++)}$(thdiv).css({textAlign:this.align,width:this.width+"px"});thdiv.innerHTML=this.innerHTML;$(this).empty().append(thdiv).removeAttr("width").mousedown(function(e){if(p.mode==0){g.dragStart("colMove",e,this)}}).hover(function(){if(!g.colresize&&!$(this).hasClass("thMove")&&!g.colCopy){$(this).addClass("thOver")}if($(this).attr("abbr")!=p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr("abbr")){$("div",this).addClass("s"+p.sortorder)}else{if($(this).attr("abbr")==p.sortname&&!g.colCopy&&!g.colresize&&$(this).attr("abbr")){var no="";if(p.sortorder=="asc"){no="desc"}else{no="asc"}$("div",this).removeClass("s"+p.sortorder).addClass("s"+no)}}if(g.colCopy){var n=$("th",g.hDiv).index(this);if(n==g.dcoln){return false}if(n<g.dcoln){$(this).append(g.cdropleft)}else{$(this).append(g.cdropright)}g.dcolt=n}else{if(!g.colresize){if(p.mode==0){var nv=$("th:visible",g.hDiv).index(this);var onl=parseInt($("div:eq("+nv+")",g.cDrag).css("left"));var nw=parseInt($(g.nBtn).width())+parseInt($(g.nBtn).css("borderLeftWidth"));if(isNaN(nw)==true){nw=0}nl=onl-nw+Math.floor(p.cgwidth/2);$(g.nDiv).hide();$(g.nBtn).hide();$(g.nBtn).css({left:nl,top:g.hDiv.offsetTop}).show();var ndw=parseInt($(g.nDiv).width());$(g.nDiv).css({top:g.bDiv.offsetTop});if((nl+ndw)>$(g.gDiv).width()){$(g.nDiv).css("left",onl-ndw+1)}else{$(g.nDiv).css("left",nl)}if($(this).hasClass("sorted")){$(g.nBtn).addClass("srtd")}else{$(g.nBtn).removeClass("srtd")}}}}},function(){$(this).removeClass("thOver");if($(this).attr("abbr")!=p.sortname){$("div",this).removeClass("s"+p.sortorder)}else{if($(this).attr("abbr")==p.sortname){var no="";if(p.sortorder=="asc"){no="desc"}else{no="asc"}$("div",this).addClass("s"+p.sortorder).removeClass("s"+no)}}if(g.colCopy){$(g.cdropleft).remove();$(g.cdropright).remove();g.dcolt=null}})});g.bDiv.className="bDiv";$(t).before(g.bDiv);$(g.bDiv).css({height:(p.height=="auto")?"auto":p.height+"px"}).scroll(function(e){g.scroll()}).append(t);if(p.height=="auto"){$("table",g.bDiv).addClass("autoht")}g.addCellProp();g.addRowProp();if(p.mode==0){var cdcol=$("thead tr:first th:first",g.hDiv).get(0);if(cdcol!=null){g.cDrag.className="cDrag";g.cdpad=0;g.cdpad+=(isNaN(parseInt($("div",cdcol).css("borderLeftWidth")))?0:parseInt($("div",cdcol).css("borderLeftWidth")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("borderRightWidth")))?0:parseInt($("div",cdcol).css("borderRightWidth")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("paddingLeft")))?0:parseInt($("div",cdcol).css("paddingLeft")));g.cdpad+=(isNaN(parseInt($("div",cdcol).css("paddingRight")))?0:parseInt($("div",cdcol).css("paddingRight")));g.cdpad+=(isNaN(parseInt($(cdcol).css("borderLeftWidth")))?0:parseInt($(cdcol).css("borderLeftWidth")));g.cdpad+=(isNaN(parseInt($(cdcol).css("borderRightWidth")))?0:parseInt($(cdcol).css("borderRightWidth")));g.cdpad+=(isNaN(parseInt($(cdcol).css("paddingLeft")))?0:parseInt($(cdcol).css("paddingLeft")));g.cdpad+=(isNaN(parseInt($(cdcol).css("paddingRight")))?0:parseInt($(cdcol).css("paddingRight")));$(g.bDiv).before(g.cDrag);var cdheight=$(g.bDiv).height();var hdheight=$(g.hDiv).height();$(g.cDrag).css({top:-hdheight+"px"});$("thead tr:first th",g.hDiv).each(function(){var cgDiv=document.createElement("div");$(g.cDrag).append(cgDiv);if(!p.cgwidth){p.cgwidth=$(cgDiv).width()}$(cgDiv).css({height:cdheight+hdheight}).mousedown(function(e){if(p.mode==0){g.dragStart("colresize",e,this)}});if($.browser.msie&&$.browser.version<7){g.fixHeight($(g.gDiv).height());$(cgDiv).hover(function(){g.fixHeight();$(this).addClass("dragging")},function(){if(!g.colresize){$(this).removeClass("dragging")}})}})}}if(p.striped){$("tbody tr:odd",g.bDiv).addClass("erow")}if(p.resizable&&p.height!="auto"){g.vDiv.className="vGrip";$(g.vDiv).mousedown(function(e){if(p.mode==0){g.dragStart("vresize",e)}}).html("<span></span>");$(g.bDiv).after(g.vDiv)}if(p.resizable&&p.width!="auto"&&!p.nohresize){g.rDiv.className="hGrip";$(g.rDiv).mousedown(function(e){if(p.mode==0){g.dragStart("vresize",e,true)}}).html("<span></span>").css("height",$(g.gDiv).height());if($.browser.msie&&$.browser.version<7){$(g.rDiv).hover(function(){$(this).addClass("hgOver")},function(){$(this).removeClass("hgOver")})}$(g.gDiv).append(g.rDiv)}if(p.usepager){g.pDiv.className="pDiv";g.pDiv.innerHTML='<div class="pDiv2 clearfix"></div>';$(g.bDiv).after(g.pDiv);var html=p.templStatusline[p.pagermode].pager.join("");html=html.replace("-=1=-",p.pageNrMsg);html=html.replace("-=2=-",p.pageNrOfMsg);html=html+p.bottom_line;$("div",g.pDiv).html(html);$(".pReload",g.pDiv).click(function(){g.populate()});$(".pFirst",g.pDiv).click(function(){g.changePage("first")});$(".pPrev",g.pDiv).click(function(){g.changePage("prev")});$(".pNext",g.pDiv).click(function(){g.changePage("next")});$(".pLast",g.pDiv).click(function(){g.changePage("last")});$(".pcontrol input",g.pDiv).keydown(function(e){if(e.keyCode==13){g.changePage("input")}});if($.browser.msie&&$.browser.version<7){$(".pButton",g.pDiv).hover(function(){$(this).addClass("pBtnOver")},function(){$(this).removeClass("pBtnOver")})}$("div.pBoxes",g.pDiv).html("");if(p.useRp){var opt="";for(var nx=0;nx<p.rpOptions.length;nx++){if(p.rp==p.rpOptions[nx]){sel='selected="selected"'}else{sel=""}opt+="<option value='"+p.rpOptions[nx]+"' "+sel+" >"+p.rpOptions[nx]+"&nbsp;&nbsp;</option>"}$(".pDiv2",g.pDiv).prepend("<div class='pGroup'><select name='rp'>"+opt+"</select></div> <div class='btnseparator'></div>");$("select",g.pDiv).change(function(){if(p.onRpChange){p.onRpChange(+this.value)}else{p.newp=1;p.rp=+this.value;g.populate()}})}if(p.searchitems){$(".pDiv2",g.pDiv).prepend("<div class='pGroup'> <div class='pSearch pButton'><span></span></div> </div>  <div class='btnseparator'></div>");$(".pSearch",g.pDiv).click(function(){$(g.sDiv).slideToggle("fast",function(){$(".sDiv:visible input:first",g.gDiv).trigger("focus")})});g.sDiv.className="sDiv";sitems=p.searchitems;var sopt="";for(var s=0;s<sitems.length;s++){if(p.qtype==""&&sitems[s].isdefault==true){p.qtype=sitems[s].name;sel='selected="selected"'}else{sel=""}sopt+="<option value='"+sitems[s].name+"' "+sel+" >"+sitems[s].display+"&nbsp;&nbsp;</option>"}if(p.qtype==""){p.qtype=sitems[0].name}$(g.sDiv).append("<div class='sDiv2'>Quick Search <input type='text' size='30' name='q' class='qsbox' /> <select name='qtype'>"+sopt+"</select> <input type='button' value='Clear' /></div>");$("input[name=q],select[name=qtype]",g.sDiv).keydown(function(e){if(e.keyCode==13){g.doSearch()}});$("input[value=Clear]",g.sDiv).click(function(){$("input[name=q]",g.sDiv).val("");p.query="";g.doSearch()});$(g.bDiv).after(g.sDiv)}}$(g.pDiv,g.sDiv).append("<div style='clear:both'></div>");if(p.title){g.mDiv.className="mDiv";g.mDiv.innerHTML='<div class="ftitle">'+p.title+"</div>";$(g.gDiv).prepend(g.mDiv);if(p.showTableToggleBtn){$(g.mDiv).append('<div class="ptogtitle" title="Minimize/Maximize Table"><span></span></div>');$("div.ptogtitle",g.mDiv).click(function(){$(g.gDiv).toggleClass("hideBody");$(this).toggleClass("vsble")})}}g.cdropleft=document.createElement("span");g.cdropleft.className="cdropleft";g.cdropright=document.createElement("span");g.cdropright.className="cdropright";g.block.className="gBlock";var gh=$(g.bDiv).height();var gtop=g.bDiv.offsetTop;$(g.block).css({width:g.bDiv.style.width,height:gh,background:"white",position:"relative",marginBottom:(gh*-1),zIndex:1,top:gtop,left:"0px"});$(g.block).fadeTo(0,p.blockOpacity);if(p.mode==0){if($("th",g.hDiv).length){g.nDiv.className="nDiv";g.nDiv.innerHTML="<table cellpadding='0' cellspacing='0'><tbody></tbody></table>";$(g.nDiv).css({marginBottom:(gh*-1),display:"none",top:gtop}).noSelect();var cn=0;$("th div",g.hDiv).each(function(){var kcol=$("th[axis='col"+cn+"']",g.hDiv)[0];var chk='checked="checked"';if(kcol.style.display=="none"){chk=""}$("tbody",g.nDiv).append('<tr><td class="ndcol1"><input type="checkbox" '+chk+' class="togCol" value="'+cn+'" /></td><td class="ndcol2">'+this.innerHTML+"</td></tr>");cn++});if($.browser.msie&&$.browser.version<7){$("tr",g.nDiv).hover(function(){$(this).addClass("ndcolover")},function(){$(this).removeClass("ndcolover")})}$("td.ndcol2",g.nDiv).click(function(){if($("input:checked",g.nDiv).length<=p.minColToggle&&$(this).prev().find("input")[0].checked){return false}return g.toggleCol($(this).prev().find("input").val())});$("input.togCol",g.nDiv).click(function(){if($("input:checked",g.nDiv).length<p.minColToggle&&this.checked==false){return false}$(this).parent().next().trigger("click")});$(g.gDiv).prepend(g.nDiv);$(g.nBtn).addClass("nBtn").html("<div></div>").attr("title","Hide/Show Columns").click(function(){$(g.nDiv).toggle();return true});if(p.showToggleBtn){$(g.gDiv).prepend(g.nBtn)}}}$(g.iDiv).addClass("iDiv").css({display:"none"});$(g.bDiv).append(g.iDiv);$(g.bDiv).hover(function(){if(p.mode==0){$(g.nDiv).hide();$(g.nBtn).hide()}},function(){if(g.multisel){g.multisel=false}});$(g.gDiv).hover(function(){},function(){if(p.mode==0){$(g.nDiv).hide();$(g.nBtn).hide()}});if(p.mode==0){$(document).mousemove(function(e){g.dragMove(e)}).mouseup(function(e){g.dragEnd()}).hover(function(){},function(){g.dragEnd()})}if($.browser.msie&&$.browser.version<7){$(".hDiv,.bDiv,.mDiv,.pDiv,.vGrip,.tDiv, .sDiv",g.gDiv).css({width:"100%"});$(g.gDiv).addClass("ie6");if(p.width!="auto"){$(g.gDiv).addClass("ie6fullwidthbug")}}g.rePosDrag();g.fixHeight();t.p=p;t.grid=g;if(p.url&&p.autoload){g.populate()}return t};var docloaded=false;$(document).ready(function(){docloaded=true});$.fn.flexigrid=function(p){return this.each(function(){if(!docloaded){$(this).hide();var t=this;$(document).ready(function(){$.addFlex(t,p)})}else{$.addFlex(this,p)}})};$.fn.flexReload=function(p){return this.each(function(){if(this.grid&&this.p.url){this.grid.populate()}})};$.fn.flexOptions=function(p){return this.each(function(){if(this.grid){$.extend(this.p,p)}})};$.fn.flexToggleCol=function(cid,visible){return this.each(function(){if(this.grid){this.grid.toggleCol(cid,visible)}})};$.fn.flexAddData=function(data){return this.each(function(){if(this.grid){this.grid.addData(data)}})};$.fn.noSelect=function(p){if(p==null){prevent=true}else{prevent=p}if(prevent){return this.each(function(){if($.browser.msie||$.browser.safari){$(this).bind("selectstart",function(){return false})}else{if($.browser.mozilla){$(this).css("MozUserSelect","none");$("body").trigger("focus")}else{if($.browser.opera){$(this).bind("mousedown",function(){return false})}else{$(this).attr("unselectable","on")}}}})}else{return this.each(function(){if($.browser.msie||$.browser.safari){$(this).unbind("selectstart")}else{if($.browser.mozilla){$(this).css("MozUserSelect","inherit")}else{if($.browser.opera){$(this).unbind("mousedown")}else{$(this).removeAttr("unselectable","on")}}}})}}})(jQuery);(function(b){var a=function(){var c={},o={years:"datepickerViewYears",months:"datepickerViewMonths",days:"datepickerViewDays"},l={wrapper:{"default":'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>'},head:{"default":["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>','<th class="datepickerDel"><a href="#"><span>&nbsp;</span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=week%></span></th>","<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"]},space:{"default":'<td class="datepickerSpace"><div></div></td>'},days:{"default":['<tbody class="datepickerDays">',"<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[0].week%></span></a></th>','<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[1].week%></span></a></th>','<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[2].week%></span></a></th>','<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[3].week%></span></a></th>','<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[4].week%></span></a></th>','<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[5].week%></span></a></th>','<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span class="cal"><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"]},months:{"default":['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>",'<tr class="last_child">','<td colspan="8"><a href="#"><span>&nbsp;</span></a></td>',"</tr>","</tbody>"]}},g={flat:false,starts:1,prev:"&#171;",next:"&#187;",lastSel:false,mode:"single",startView:"days",endView:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",allowDelete:false,notInMothClickable:true,onRender:function(){return{}},onChange:function(){return true},onChangeRange:function(t,s){},hideOnChange:false,onShow:function(){return true},onBeforeShow:function(){return true},onHide:function(){return true},data:{},template_w:"default",template_h:"default",template_s:"default",template_d:"default",template_m:"default",locale:{days:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota","Niedziela"],daysShort:["Nie","Pon","Wto","Śro","Czw","Pią","Sob","Nie"],daysMin:["Ni","Po","Wt","Sr","Cz","Pi","So","Ni"],months:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthsShort:["Sty","Luty","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"],weekMin:"Ty"}},q=function(v){var y=b(v).data("datepicker");var E=b(v);var w=Math.floor(y.calendars/2),R,T,H,S,O=0,L,A,x,C,D,I;var H;dateS=new Date(y.current);dateS.addMonths(-w+0);dateE=new Date(y.current);dateE.addMonths(-w+(y.calendars-1));var s=new Date(dateS);var H=(s.getDay()-y.starts)%7;s.addDays(-(H+(H<0?7:0)));var B=new Date(s);B.addDays(41);var z=new Date(dateE);var H=(z.getDay()-y.starts)%7;z.addDays(-(H+(H<0?7:0)));var G=new Date(z);G.addDays(41);y.onChangeRange.apply(this,[s,G]);E.find("td>table tbody").remove();for(var P=0;P<y.calendars;P++){R=new Date(y.current);R.addMonths(-w+P);I=E.find("table").eq(P+1);switch(I[0].className){case"datepickerViewDays":H=r(R,"B, Y");break;case"datepickerViewMonths":H=R.getFullYear();break;case"datepickerViewYears":H=(R.getFullYear()-6)+" - "+(R.getFullYear()+5);break}I.find("thead tr:first th:eq(1) span").text(H);H=R.getFullYear()-6;T={data:[],className:"datepickerYears"};for(var N=0;N<12;N++){T.data.push(H+N)}D=tmpl(l.months[y.template_m].join(""),T);R.setDate(1);T={weeks:[],test:10};S=R.getMonth();var H=(R.getDay()-y.starts)%7;R.addDays(-(H+(H<0?7:0)));L=-1;O=0;while(O<42){x=parseInt(O/7,10);C=O%7;if(!T.weeks[x]){L=R.getWeekNumber();T.weeks[x]={week:L,days:[]}}var M=R.getDate();if(M<10){M="0"+M}var Q=R.getMonth()+1;if(Q<10){Q="0"+Q}var u=R.getFullYear()+"-"+Q+"-"+M;var F="";F="";var K="";K="";var t="";t="";if(y.data[u]!=undefined){if(y.data[u]["price"]!=undefined){F=y.data[u]["price"]}if(y.data[u]["com"]!=undefined){K=y.data[u]["com"]}if(y.data[u]["state"]!=undefined){t=y.data[u]["state"]}if(y.data[u]["ex"]!=undefined){t=t+" "+y.data[u]["ex"]}}T.weeks[x].days[C]={text:R.getDate(),classname:[],price:"",com:"",sclassname:""};T.weeks[x].days[C]["price"]=F;T.weeks[x].days[C]["com"]=K;T.weeks[x].days[C]["sclassname"]=t;if(S!=R.getMonth()){T.weeks[x].days[C].classname.push("datepickerNotInMonth")}if(R.getDay()==0){T.weeks[x].days[C].classname.push("datepickerSunday")}if(R.getDay()==6){T.weeks[x].days[C].classname.push("datepickerSaturday")}var J=y.onRender(R);var U=R.valueOf();if(J.selected||y.date==U||b.inArray(U,y.date)>-1||((y.mode=="range"||y.mode=="range_multi")&&U>=y.date[0]&&U<=y.date[1])){T.weeks[x].days[C].classname.push("datepickerSelected")}if(J.disabled){T.weeks[x].days[C].classname.push("datepickerDisabled")}if(J.className){T.weeks[x].days[C].classname.push(J.className)}T.weeks[x].days[C].classname=T.weeks[x].days[C].classname.join(" ");O++;R.addDays(1)}D=tmpl(l.days[y.template_d].join(""),T)+D;T={data:y.locale.monthsShort,className:"datepickerMonths"};D=tmpl(l.months[y.template_m].join(""),T)+D;I.append(D)}},e=function(t,D){if(t.constructor==Date){return new Date(t)}var x=t.split(/\W+/);var u=D.split(/\W+/),B,v,C,A,w,s=new Date();for(var z=0;z<x.length;z++){switch(u[z]){case"d":case"e":B=parseInt(x[z],10);break;case"m":v=parseInt(x[z],10)-1;break;case"Y":case"y":C=parseInt(x[z],10);C+=C>100?0:(C<29?2000:1900);break;case"H":case"I":case"k":case"l":A=parseInt(x[z],10);break;case"P":case"p":if(/pm/i.test(x[z])&&A<12){A+=12}else{if(/am/i.test(x[z])&&A>=12){A-=12}}break;case"M":w=parseInt(x[z],10);break}}return new Date(C===undefined?s.getFullYear():C,v===undefined?s.getMonth():v,B===undefined?s.getDate():B,A===undefined?s.getHours():A,w===undefined?s.getMinutes():w,0)},r=function(u,G){var v=u.getMonth();var E=u.getDate();var F=u.getFullYear();var H=u.getWeekNumber();var I=u.getDay();var L={};var J=u.getHours();var x=(J>=12);var C=(x)?(J-12):J;var K=u.getDayOfYear();if(C==0){C=12}var A=u.getMinutes();var D=u.getSeconds();var z=G.split(""),t;for(var B=0;B<z.length;B++){t=z[B];switch(z[B]){case"a":t=u.getDayName();break;case"A":t=u.getDayName(true);break;case"b":t=u.getMonthName();break;case"B":t=u.getMonthName(true);break;case"C":t=1+Math.floor(F/100);break;case"d":t=(E<10)?("0"+E):E;break;case"e":t=E;break;case"H":t=(J<10)?("0"+J):J;break;case"I":t=(C<10)?("0"+C):C;break;case"j":t=(K<100)?((K<10)?("00"+K):("0"+K)):K;break;case"k":t=J;break;case"l":t=C;break;case"m":t=(v<9)?("0"+(1+v)):(1+v);break;case"M":t=(A<10)?("0"+A):A;break;case"p":case"P":t=x?"PM":"AM";break;case"s":t=Math.floor(u.getTime()/1000);break;case"S":t=(D<10)?("0"+D):D;break;case"u":t=I+1;break;case"w":t=I;break;case"y":t=(""+F).substr(2,2);break;case"Y":t=F;break}z[B]=t}return z.join("")},f=function(s){if(Date.prototype.tempDate){return}Date.prototype.tempDate=null;Date.prototype.months=s.months;Date.prototype.monthsShort=s.monthsShort;Date.prototype.days=s.days;Date.prototype.daysShort=s.daysShort;Date.prototype.getMonthName=function(t){return this[t?"months":"monthsShort"][this.getMonth()]};Date.prototype.getDayName=function(t){return this[t?"days":"daysShort"][this.getDay()]};Date.prototype.addDays=function(t){this.setDate(this.getDate()+t);this.tempDate=this.getDate()};Date.prototype.addMonths=function(t){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setMonth(this.getMonth()+t);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.addYears=function(t){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setFullYear(this.getFullYear()+t);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.getMaxDays=function(){var u=new Date(Date.parse(this)),v=28,t;t=u.getMonth();v=28;while(u.getMonth()==t){v++;u.setDate(v)}return v-1};Date.prototype.getFirstDay=function(){var t=new Date(Date.parse(this));t.setDate(1);return t.getDay()};Date.prototype.getWeekNumber=function(){var t=new Date(this);t.setDate(t.getDate()-(t.getDay()+6)%7+3);var u=t.valueOf();t.setMonth(0);t.setDate(4);return Math.round((u-t.valueOf())/(604800000))+1};Date.prototype.getDayOfYear=function(){var t=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var v=new Date(this.getFullYear(),0,0,0,0,0);var u=t-v;return Math.floor(u/24*60*60*1000)}},j=function(w){var t=b(w).data("datepicker");var y=b("#"+t.id);if(!t.extraHeight){var v=b(w).find("div");t.extraHeight=v.get(0).offsetHeight+v.get(1).offsetHeight;t.extraWidth=v.get(2).offsetWidth+v.get(3).offsetWidth}var x=y.find("table:first").get(0);var u=x.offsetWidth;var s=x.offsetHeight;y.css({width:u+t.extraWidth+"px",height:s+t.extraHeight+"px"}).find("div.datepickerContainer").css({width:u+"px",height:s+"px"})},p=function(z){if(b(z.target).is("span")){z.target=z.target.parentNode}var u=b(z.target);if(u.is("a")){z.target.blur();if(u.hasClass("datepickerDisabled")){return false}var B=b(this).data("datepicker");var y=u.parent();var t=y.parent().parent().parent();var A=b("table",this).index(t.get(0))-1;var x=new Date(B.current);var w=false;var s=false;if(y.is("th")){if(y.hasClass("datepickerDel")){if(B.allowDelete==true){B.date="";B.onChange.apply(this,["","",B.el]);b("#"+b(this).data("datepicker").id).hide()}return false}else{if(y.hasClass("datepickerWeek")&&(B.mode=="range"||B.mode=="range_multi")&&!y.next().hasClass("datepickerDisabled")){var v=parseInt(y.next().text(),10);x.addMonths(A-Math.floor(B.calendars/2));if(y.next().hasClass("datepickerNotInMonth")){x.addMonths(v>15?-1:1)}x.setDate(v);B.date[0]=(x.setHours(0,0,0,0)).valueOf();x.setHours(23,59,59,0);x.addDays(6);B.date[1]=x.valueOf();s=true;w=true;B.lastSel=false}else{if(y.hasClass("datepickerMonth")){x.addMonths(A-Math.floor(B.calendars/2));switch(t.get(0).className){case"datepickerViewDays":t.get(0).className="datepickerViewMonths";u.find("span").text(x.getFullYear());break;case"datepickerViewMonths":t.get(0).className="datepickerViewYears";u.find("span").text((x.getFullYear()-6)+" - "+(x.getFullYear()+5));break;case"datepickerViewYears":t.get(0).className="datepickerViewDays";u.find("span").text(r(x,"B, Y"));break}}else{if(y.parent().parent().is("thead")){switch(t.get(0).className){case"datepickerViewDays":B.current.addMonths(y.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":B.current.addYears(y.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":B.current.addYears(y.hasClass("datepickerGoPrev")?-12:12);break}s=true}}}}}else{if(y.is("td")&&!y.hasClass("datepickerDisabled")){switch(t.get(0).className){case"datepickerViewMonths":B.current.setMonth(t.find("tbody.datepickerMonths td").index(y));B.current.setFullYear(parseInt(t.find("thead th.datepickerMonth span").text(),10));B.current.addMonths(Math.floor(B.calendars/2)-A);x=new Date(B.current);if(B.endView=="months"){switch(B.mode){case"multiple":break;case"range":break;case"range_multi":break;default:var v=1;x.addMonths(A-Math.floor(B.calendars/2));if(y.hasClass("datepickerNotInMonth")){x.addMonths(v>15?-1:1)}x.setDate(v);B.date=x.valueOf()}w=true}else{t.get(0).className="datepickerViewDays"}break;case"datepickerViewYears":B.current.setFullYear(parseInt(u.text(),10));B.current.setMonth(0);B.current.addMonths(Math.floor(B.calendars/2)-A);x=new Date(B.current);if(B.endView=="years"){switch(B.mode){case"multiple":break;case"range":break;case"range_multi":break;default:var v=1;x.addMonths(A-Math.floor(B.calendars/2));if(y.hasClass("datepickerNotInMonth")){x.addMonths(v>15?-1:1)}x.setDate(v);B.date=x.valueOf()}w=true}else{t.get(0).className="datepickerViewMonths"}break;default:var v=parseInt(u.find(".cal").text(),10);x.addMonths(A-Math.floor(B.calendars/2));if(y.hasClass("datepickerNotInMonth")){x.addMonths(v>15?-1:1);if(B.notInMothClickable==false){return false}}x.setDate(v);switch(B.mode){case"multiple":v=(x.setHours(0,0,0,0)).valueOf();if(b.inArray(v,B.date)>-1){b.each(B.date,function(C,D){if(D==v){B.date.splice(C,1);return false}})}else{B.date.push(v)}break;case"range":if(!B.lastSel){B.date[0]=(x.setHours(0,0,0,0)).valueOf()}v=(x.setHours(23,59,59,0)).valueOf();if(v<B.date[0]){B.date[1]=B.date[0]+86399000;B.date[0]=v-86399000}else{B.date[1]=v}B.lastSel=!B.lastSel;break;case"range_multi":if(!B.lastSel){B.date[0]=(x.setHours(0,0,0,0)).valueOf();B.date[1]=(x.setHours(0,0,0,0)).valueOf()}v=(x.setHours(23,59,59,0)).valueOf();if(v<B.date[0]){B.date[1]=B.date[0]+86399000;B.date[0]=v-86399000}else{B.date[1]=v}B.lastSel=!B.lastSel;break;default:B.date=x.valueOf();break}w=true;break}s=true}}if(s){q(this)}if(w){B.onChange.apply(this,k(B));if(B.hideOnChange==true){b("#"+b(this).data("datepicker").id).hide()}}}return false},k=function(s){var t;if(s.mode=="single"){t=new Date(s.date);return[r(t,s.format),t,s.el]}else{t=[[],[],s.el];b.each(s.date,function(v,w){var u=new Date(w);t[0].push(r(u,s.format));t[1].push(u)});return t}},d=function(){var s=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(s?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(s?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(s?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(s?document.documentElement.clientHeight:document.body.clientHeight)}},m=function(u,t,s){if(u==t){return true}if(u.contains){return u.contains(t)}if(u.compareDocumentPosition){return !!(u.compareDocumentPosition(t)&16)}var v=t.parentNode;while(v&&v!=s){if(v==u){return true}v=v.parentNode}return false},n=function(y){var s=b("#"+b(this).data("datepickerId"));if(!s.is(":visible")){var z=s.get(0);var B=s.data("datepicker");var t=s.find("tr:first").find("table");t.removeClass(o.years);t.removeClass(o.moths);t.removeClass(o.days);t.addClass(o[B.startView]);q(z);B.onBeforeShow.apply(this,[s.get(0)]);var w=b(this).offset();var A=d();var x=w.top;var u=w.left;var v=b.curCSS(z,"display");s.css({visibility:"hidden",display:"block"});j(z);switch(B.position){case"top":x-=z.offsetHeight;break;case"left":u-=z.offsetWidth;break;case"right":u+=this.offsetWidth;break;case"bottom":x+=this.offsetHeight;break}if(x+z.offsetHeight>A.t+A.h){x=w.top-z.offsetHeight}if(x<A.t){x=w.top+this.offsetHeight+z.offsetHeight}if(u+z.offsetWidth>A.l+A.w){u=w.left-z.offsetWidth}if(u<A.l){u=w.left+this.offsetWidth}s.css({visibility:"visible",display:"block",top:x+"px",left:u+"px"});if(B.onShow.apply(this,[s.get(0)])!=false){s.show()}b(document).bind("mousedown",{cal:s,trigger:this},h)}return false},h=function(s){if(s.target!=s.data.trigger&&!m(s.data.cal.get(0),s.target,s.data.cal.get(0))){if(s.data.cal.data("datepicker").onHide.apply(this,[s.data.cal.get(0)])!=false){s.data.cal.hide()}b(document).unbind("mousedown",h)}};return{init:function(s){s=b.extend({},g,s||{});f(s.locale);s.calendars=Math.max(1,parseInt(s.calendars,10)||1);s.mode=/single|multiple|range/.test(s.mode)?s.mode:"single";return this.each(function(){if(!b(this).data("datepicker")){s.el=this;if(s.date.constructor==String){s.date=e(s.date,s.format);s.date.setHours(0,0,0,0)}if(s.mode!="single"){if(s.date.constructor!=Array){s.date=[s.date.valueOf()];if(s.mode=="range"){s.date.push(((new Date(s.date[0])).setHours(23,59,59,0)).valueOf())}if(s.mode=="range_multi"){s.date.push(((new Date(s.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var v=0;v<s.date.length;v++){s.date[v]=(e(s.date[v],s.format).setHours(0,0,0,0)).valueOf()}if(s.mode=="range"){s.date[1]=((new Date(s.date[1])).setHours(23,59,59,0)).valueOf()}if(s.mode=="range_multi"){s.date[1]=((new Date(s.date[1])).setHours(23,59,59,0)).valueOf()}}}else{s.date=s.date.valueOf()}if(!s.current){s.current=new Date()}else{s.current=e(s.current,s.format)}s.current.setDate(1);s.current.setHours(0,0,0,0);var x="datepicker_"+parseInt(Math.random()*1000),u;s.id=x;b(this).data("datepickerId",s.id);var w=b(l.wrapper[s.template_w]).attr("id",x).bind("click",p).data("datepicker",s);if(s.className){w.addClass(s.className)}var t="";for(var v=0;v<s.calendars;v++){u=s.starts;if(v>0){t+=l.space[s.template_s]}t+=tmpl(l.head[s.template_h].join(""),{week:s.locale.weekMin,prev:s.prev,next:s.next,day1:s.locale.daysMin[(u++)%7],day2:s.locale.daysMin[(u++)%7],day3:s.locale.daysMin[(u++)%7],day4:s.locale.daysMin[(u++)%7],day5:s.locale.daysMin[(u++)%7],day6:s.locale.daysMin[(u++)%7],day7:s.locale.daysMin[(u++)%7]})}w.find("tr:first").append(t).find("table").addClass(o[s.startView]);if(s.allowDelete==false){w.find(".datepickerDel").hide()}q(w.get(0));if(s.flat){w.appendTo(this).show().css("position","relative");j(w.get(0))}else{w.appendTo(document.body);b(this).bind(s.eventName,n)}}})},setOptions:function(s){return this.each(function(){if(b(this).data("datepickerId")){var u=b("#"+b(this).data("datepickerId"));var t=u.data("datepicker");t=b.extend({},t,s||{});u.data("datepicker",t);q(u)}})},getOptions:function(){if(b(this).data("datepickerId")){var t=b("#"+b(this).data("datepickerId"));var s=t.data("datepicker");return s}},showPicker:function(){return this.each(function(){if(b(this).data("datepickerId")){n.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("datepickerId")){b("#"+b(this).data("datepickerId")).hide()}})},setDate:function(s,t){return this.each(function(){if(b(this).data("datepickerId")){var w=b("#"+b(this).data("datepickerId"));var u=w.data("datepicker");u.date=s;if(u.date.constructor==String){u.date=e(u.date,u.format);u.date.setHours(0,0,0,0)}if(u.mode!="single"){if(u.date.constructor!=Array){u.date=[u.date.valueOf()];if(u.mode=="range"){u.date.push(((new Date(u.date[0])).setHours(23,59,59,0)).valueOf())}if(u.mode=="range_multi"){u.date.push(((new Date(u.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var v=0;v<u.date.length;v++){u.date[v]=(e(u.date[v],u.format).setHours(0,0,0,0)).valueOf()}if(u.mode=="range"){u.date[1]=((new Date(u.date[1])).setHours(23,59,59,0)).valueOf()}if(u.mode=="range_multi"){u.date[1]=((new Date(u.date[1])).setHours(23,59,59,0)).valueOf()}}}else{u.date=u.date.valueOf()}if(t){u.current=new Date(u.mode!="single"?u.date[0]:u.date)}q(w.get(0))}})},getDate:function(s){if(this.size()>0){return k(b("#"+b(this).data("datepickerId")).data("datepicker"))[s?0:1]}},clear:function(){return this.each(function(){if(b(this).data("datepickerId")){var t=b("#"+b(this).data("datepickerId"));var s=t.data("datepicker");if(s.mode!="single"){s.date=[];q(t.get(0))}}})},fixLayout:function(){return this.each(function(){if(b(this).data("datepickerId")){var t=b("#"+b(this).data("datepickerId"));var s=t.data("datepicker");if(s.flat){j(t.get(0))}}})}}}();b.fn.extend({DatePicker:a.init,DatePickerSetOptions:a.setOptions,DatePickerGetOptions:a.getOptions,DatePickerHide:a.hidePicker,DatePickerShow:a.showPicker,DatePickerSetDate:a.setDate,DatePickerGetDate:a.getDate,DatePickerClear:a.clear,DatePickerLayout:a.fixLayout});if(typeof locale=="undefined"){locale={}}if(typeof locale.objects=="undefined"){locale.objects={}}locale.objects.datepicker=a})(jQuery);(function(){var b={};this.tmpl=function a(e,d){var c=!/\W/.test(e)?b[e]=b[e]||a(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return d?c(d):c}})();(function($){$.contextMenu={shadow:true,shadowOffset:0,shadowOffsetX:5,shadowOffsetY:5,shadowWidthAdjust:-3,shadowHeightAdjust:-3,shadowOpacity:0.2,shadowClass:"context-menu-shadow",shadowColor:"black",offsetX:0,offsetY:0,appendTo:"body",direction:"down",constrainToScreen:true,showTransition:"show",hideTransition:"hide",showSpeed:null,hideSpeed:null,showCallback:null,hideCallback:null,className:"context-menu",itemClassName:"context-menu-item",itemHoverClassName:"context-menu-item-hover",disabledItemClassName:"context-menu-item-disabled",disabledItemHoverClassName:"context-menu-item-disabled-hover",separatorClassName:"context-menu-separator",innerDivClassName:"context-menu-item-inner",themePrefix:"context-menu-theme-",theme:"default",separator:"context-menu-separator",target:null,menu:null,shadowObj:null,bgiframe:null,shown:false,useIframe:
/*@cc_on @*/
/*@if (@_win32) true, @else @*/
false,
/*@end @*/
create:function(menu,opts){var cmenu=$.extend({},this,opts);if(typeof menu=="string"){cmenu.menu=$(menu)}else{if(typeof menu=="function"){cmenu.menuFunction=menu}else{cmenu.menu=cmenu.createMenu(menu,cmenu)}}if(cmenu.menu){cmenu.menu.css({display:"none"});if(menu.length>0){$(cmenu.appendTo).append(cmenu.menu)}}if(cmenu.shadow){cmenu.createShadow(cmenu);if(cmenu.shadowOffset){cmenu.shadowOffsetX=cmenu.shadowOffsetY=cmenu.shadowOffset}}$("body").bind("contextmenu",function(){cmenu.hide()});return cmenu},createIframe:function(){return $('<iframe frameborder="0" tabindex="-1" src="javascript:false" style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=0);"/>')},createMenu:function(menu,cmenu){var className=cmenu.className;$.each(cmenu.theme.split(","),function(i,n){className+=" "+cmenu.themePrefix+n});var $t=$('<table class="context-menu-main" cellspacing=0 cellpadding=0></table>').click(function(){cmenu.hide();return false});var $tr=$("<tr></tr>");var $td=$("<td></td>");var $div=$('<div class="'+className+'"></div>');for(var i=0;i<menu.length;i++){var m=menu[i];if(m==$.contextMenu.separator){$div.append(cmenu.createSeparator())}else{for(var opt in menu[i]){$div.append(cmenu.createMenuItem(opt,menu[i][opt]))}}}if(cmenu.useIframe){$td.append(cmenu.createIframe())}$t.append($tr.append($td.append($div)));return $t},createMenuItem:function(label,obj){var cmenu=this;if(typeof obj=="function"){obj={onclick:obj}}var o=$.extend({onclick:function(){},className:"",hoverClassName:cmenu.itemHoverClassName,icon:"",disabled:false,title:"",hoverItem:cmenu.hoverItem,hoverItemOut:cmenu.hoverItemOut},obj);var iconStyle=(o.icon)?"background-image:url("+o.icon+");":"";var $div=$('<div class="'+cmenu.itemClassName+" "+o.className+((o.disabled)?" "+cmenu.disabledItemClassName:"")+'" title="'+o.title+'"></div>').click(function(e){if(cmenu.isItemDisabled(this)){return false}else{return o.onclick.call(cmenu.target,this,cmenu,e)}}).hover(function(){o.hoverItem.call(this,(cmenu.isItemDisabled(this))?cmenu.disabledItemHoverClassName:o.hoverClassName)},function(){o.hoverItemOut.call(this,(cmenu.isItemDisabled(this))?cmenu.disabledItemHoverClassName:o.hoverClassName)});var $idiv=$('<div class="'+cmenu.innerDivClassName+'" style="'+iconStyle+'">'+label+"</div>");$div.append($idiv);return $div},createSeparator:function(){return $('<div class="'+this.separatorClassName+'"></div>')},isItemDisabled:function(item){return $(item).is("."+this.disabledItemClassName)},hoverItem:function(c){$(this).addClass(c)},hoverItemOut:function(c){$(this).removeClass(c)},createShadow:function(cmenu){cmenu.shadowObj=$('<div class="'+cmenu.shadowClass+'"></div>').css({display:"none",position:"absolute",zIndex:9998,opacity:cmenu.shadowOpacity,backgroundColor:cmenu.shadowColor});$(cmenu.appendTo).append(cmenu.shadowObj)},showShadow:function(x,y,e){var cmenu=this;if(cmenu.shadow){cmenu.shadowObj.css({width:(cmenu.menu.width()+cmenu.shadowWidthAdjust)+"px",height:(cmenu.menu.height()+cmenu.shadowHeightAdjust)+"px",top:(y+cmenu.shadowOffsetY)+"px",left:(x+cmenu.shadowOffsetX)+"px"}).addClass(cmenu.shadowClass)[cmenu.showTransition](cmenu.showSpeed)}},beforeShow:function(){return true},show:function(t,e){$("table.context-menu-main").hide();$("div.context-menu-shadow").hide();var cmenu=this,x=e.pageX,y=e.pageY;cmenu.target=t;if(cmenu.beforeShow()!==false){if(cmenu.menuFunction){if(cmenu.menu){$(cmenu.menu).remove()}cmenu.menu=cmenu.createMenu(cmenu.menuFunction(cmenu,t),cmenu);cmenu.menu.css({display:"none"});$(cmenu.appendTo).append(cmenu.menu)}var $c=cmenu.menu;x+=cmenu.offsetX;y+=cmenu.offsetY;var pos=cmenu.getPosition(x,y,cmenu,e);cmenu.showShadow(pos.x,pos.y,e);if(cmenu.useIframe){$c.find("iframe").css({width:$c.width()+cmenu.shadowOffsetX+cmenu.shadowWidthAdjust,height:$c.height()+cmenu.shadowOffsetY+cmenu.shadowHeightAdjust})}$c.css({top:pos.y+"px",left:pos.x+"px",position:"absolute",zIndex:9999})[cmenu.showTransition](cmenu.showSpeed,((cmenu.showCallback)?function(){cmenu.showCallback.call(cmenu)}:null));cmenu.shown=true;$(document).one("click",null,function(){cmenu.hide()})}},getPosition:function(clickX,clickY,cmenu,e){var x=clickX+cmenu.offsetX;var y=clickY+cmenu.offsetY;var h=$(cmenu.menu).height();var w=$(cmenu.menu).width();var dir=cmenu.direction;if(cmenu.constrainToScreen){var $w=$(window);var wh=$w.height();var ww=$w.width();if(dir=="down"&&(y+h-$w.scrollTop()>wh)){dir="up"}var maxRight=x+w-$w.scrollLeft();if(maxRight>ww){x-=(maxRight-ww)}}if(dir=="up"){y-=h}return{x:x,y:y}},hide:function(){var cmenu=this;if(cmenu.shown){if(cmenu.iframe){$(cmenu.iframe).hide()}if(cmenu.menu){cmenu.menu[cmenu.hideTransition](cmenu.hideSpeed,((cmenu.hideCallback)?function(){cmenu.hideCallback.call(cmenu)}:null))}if(cmenu.shadow){cmenu.shadowObj[cmenu.hideTransition](cmenu.hideSpeed)}}cmenu.shown=false}};$.fn.contextMenu=function(menu,options){var cmenu=$.contextMenu.create(menu,options);return this.each(function(){$(this).bind("contextmenu",function(e){cmenu.show(this,e);return false})})}})(jQuery);